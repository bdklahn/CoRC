<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model Building • CoRC</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">CoRC</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CoRC.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/examples.html">Examples</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/entity_management.html">Managing Model Entities</a>
    </li>
    <li>
      <a href="../articles/task_management.html">Managing Tasks</a>
    </li>
    <li>
      <a href="../articles/model_building.html">Model Building</a>
    </li>
    <li>
      <a href="../articles/issues.html">Issues</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jpahle/CoRC">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Model Building</h1>
                        <h4 class="author">Jonas Förster &amp; Jürgen Pahle</h4>
            
            <h4 class="date">2018-01-19</h4>
          </div>

    
    
<div class="contents">
<div id="initial-setup" class="section level1">
<h1 class="hasAnchor">
<a href="#initial-setup" class="anchor"></a>Initial Setup</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(CoRC)</code></pre></div>
</div>
<div id="quick-model-building" class="section level1">
<h1 class="hasAnchor">
<a href="#quick-model-building" class="anchor"></a>Quick Model Building</h1>
<p>Building a quick Michaelis-Menten reaction using Copasi’s automatisms. Working with reaction schemes automatically creates required entities the same way the Copasi GUI does.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/newModel.html">newModel</a></span>()
<span class="co">#&gt; # A copasi model reference:</span>
<span class="co">#&gt; Model name: "New Model"</span>
<span class="co">#&gt; Number of compartments: 0</span>
<span class="co">#&gt; Number of species: 0</span>
<span class="co">#&gt; Number of reactions: 0</span>

<span class="kw"><a href="../reference/newReaction.html">newReaction</a></span>(<span class="st">"a = b"</span>, <span class="dt">fun =</span> <span class="st">"Reversible Michaelis-Menten"</span>)
<span class="co">#&gt; [1] "(a = b)"</span>

<span class="kw"><a href="../reference/getSpecies.html">getSpecies</a></span>()
<span class="co">#&gt; # A tibble: 2 x 12</span>
<span class="co">#&gt;   key       name  compartment type    initial_concentra…    initial_number</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;                &lt;dbl&gt;             &lt;dbl&gt;</span>
<span class="co">#&gt; 1 a{compar… a     compartment reacti…               1.00           6.02e²⁰</span>
<span class="co">#&gt; 2 b{compar… b     compartment reacti…               1.00           6.02e²⁰</span>
<span class="co">#&gt; # ... with 6 more variables: concentration &lt;dbl&gt;, number &lt;dbl&gt;, rate</span>
<span class="co">#&gt; #   &lt;dbl&gt;, number_rate &lt;dbl&gt;, initial_expression &lt;chr&gt;, expression &lt;chr&gt;</span>
<span class="kw"><a href="../reference/getReactions.html">getReactions</a></span>()
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   key     name  reaction rate_law                         flux number_flux</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;                           &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 (a = b) a = b a = b    FunctionDB.Functions[Reversibl…     0           0</span>
<span class="kw"><a href="../reference/getParameters.html">getParameters</a></span>()
<span class="co">#&gt; # A tibble: 4 x 5</span>
<span class="co">#&gt;   key         name  reaction value mapping</span>
<span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;  </span>
<span class="co">#&gt; 1 (a = b).Kms Kms   a = b    0.100 &lt;NA&gt;   </span>
<span class="co">#&gt; 2 (a = b).Kmp Kmp   a = b    0.100 &lt;NA&gt;   </span>
<span class="co">#&gt; 3 (a = b).Vf  Vf    a = b    0.100 &lt;NA&gt;   </span>
<span class="co">#&gt; 4 (a = b).Vr  Vr    a = b    0.100 &lt;NA&gt;</span>

<span class="kw"><a href="../reference/unloadModel.html">unloadModel</a></span>()</code></pre></div>
</div>
<div id="more-detail" class="section level1">
<h1 class="hasAnchor">
<a href="#more-detail" class="anchor"></a>More Detail</h1>
<p>Getting more detail in can be helpful. Here we create a global quantity “substrate concentration” which applies a fixed value to species “a”. This is achieved by assigning the <code>Value</code> reference of the global quantity to species “a”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/newModel.html">newModel</a></span>()
<span class="co">#&gt; # A copasi model reference:</span>
<span class="co">#&gt; Model name: "New Model"</span>
<span class="co">#&gt; Number of compartments: 0</span>
<span class="co">#&gt; Number of species: 0</span>
<span class="co">#&gt; Number of reactions: 0</span>

subs_quant &lt;-<span class="st"> </span><span class="kw"><a href="../reference/newGlobalQuantity.html">newGlobalQuantity</a></span>(<span class="st">"substrate concentration"</span>, <span class="dt">initial_value =</span> <span class="dv">10</span>)
subs_value &lt;-<span class="st"> </span><span class="kw"><a href="../reference/entity_finders.html">quantity</a></span>(subs_quant, <span class="dt">reference =</span> <span class="st">"Value"</span>)
subs_value
<span class="co">#&gt; [1] "{Values[substrate concentration]}"</span>

<span class="kw"><a href="../reference/newSpecies.html">newSpecies</a></span>(<span class="st">"a"</span>, <span class="dt">type =</span> <span class="st">"assignment"</span>, <span class="dt">expression =</span> subs_value)
<span class="co">#&gt; Warning: No compartment exists. Created default compartment.</span>
<span class="co">#&gt; [1] "a{compartment}"</span>
<span class="kw"><a href="../reference/newReaction.html">newReaction</a></span>(<span class="st">"a = b"</span>, <span class="dt">fun =</span> <span class="st">"Reversible Michaelis-Menten"</span>)
<span class="co">#&gt; [1] "(a = b)"</span>

<span class="kw"><a href="../reference/getGlobalQuantities.html">getGlobalQuantities</a></span>()
<span class="co">#&gt; # A tibble: 1 x 8</span>
<span class="co">#&gt;   key    name  type  initial_value value  rate initial_express… expression</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;     </span>
<span class="co">#&gt; 1 Value… subs… fixed          10.0   NaN     0 ""               ""</span>
<span class="kw"><a href="../reference/getSpecies.html">getSpecies</a></span>()
<span class="co">#&gt; # A tibble: 2 x 12</span>
<span class="co">#&gt;   key       name  compartment type    initial_concentra…    initial_number</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;                &lt;dbl&gt;             &lt;dbl&gt;</span>
<span class="co">#&gt; 1 a{compar… a     compartment assign…              10.0            6.02e²¹</span>
<span class="co">#&gt; 2 b{compar… b     compartment reacti…               1.00           6.02e²⁰</span>
<span class="co">#&gt; # ... with 6 more variables: concentration &lt;dbl&gt;, number &lt;dbl&gt;, rate</span>
<span class="co">#&gt; #   &lt;dbl&gt;, number_rate &lt;dbl&gt;, initial_expression &lt;chr&gt;, expression &lt;chr&gt;</span>
<span class="kw"><a href="../reference/getReactions.html">getReactions</a></span>()
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   key     name  reaction rate_law                         flux number_flux</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;                           &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 (a = b) a = b a = b    FunctionDB.Functions[Reversibl…     0           0</span>
<span class="kw"><a href="../reference/getParameters.html">getParameters</a></span>()
<span class="co">#&gt; # A tibble: 4 x 5</span>
<span class="co">#&gt;   key         name  reaction value mapping</span>
<span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;  </span>
<span class="co">#&gt; 1 (a = b).Kms Kms   a = b    0.100 &lt;NA&gt;   </span>
<span class="co">#&gt; 2 (a = b).Kmp Kmp   a = b    0.100 &lt;NA&gt;   </span>
<span class="co">#&gt; 3 (a = b).Vf  Vf    a = b    0.100 &lt;NA&gt;   </span>
<span class="co">#&gt; 4 (a = b).Vr  Vr    a = b    0.100 &lt;NA&gt;</span>

timecourse &lt;-<span class="st"> </span><span class="kw"><a href="../reference/runTimeCourse.html">runTC</a></span>(<span class="dv">1000</span>)

<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/autoplot">autoplot</a></span>(timecourse)</code></pre></div>
<p><img src="model_building_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw"><a href="../reference/unloadModel.html">unloadModel</a></span>()</code></pre></div>
</div>
<div id="defining-reaction-kinetics-manually" class="section level1">
<h1 class="hasAnchor">
<a href="#defining-reaction-kinetics-manually" class="anchor"></a>Defining Reaction Kinetics Manually</h1>
<p>In previous examples, we used the predefined “Reversible Michaelis-Menten” kinetic functions. In this example we create an equivalent function manually to achieve the same result.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/newModel.html">newModel</a></span>()
<span class="co">#&gt; # A copasi model reference:</span>
<span class="co">#&gt; Model name: "New Model"</span>
<span class="co">#&gt; Number of compartments: 0</span>
<span class="co">#&gt; Number of species: 0</span>
<span class="co">#&gt; Number of reactions: 0</span>

<span class="kw"><a href="../reference/newCompartment.html">newCompartment</a></span>(<span class="st">"compartment"</span>)
<span class="co">#&gt; [1] "Compartments[compartment]"</span>
<span class="kw"><a href="../reference/newSpecies.html">newSpecies</a></span>(<span class="st">"a"</span>, <span class="dt">type =</span> <span class="st">"fixed"</span>, <span class="dt">initial_concentration =</span> <span class="dv">10</span>)
<span class="co">#&gt; [1] "a{compartment}"</span>
<span class="kw"><a href="../reference/newSpecies.html">newSpecies</a></span>(<span class="st">"b"</span>)
<span class="co">#&gt; [1] "b{compartment}"</span>
<span class="kw"><a href="../reference/newKineticFunction.html">newKineticFunction</a></span>(
  <span class="st">"manual MM"</span>,
  <span class="st">"((Vf * substrate) / Kms - Vr * product / Kmp) / (1 + substrate / Kms + product / Kms)"</span>,
  <span class="dt">parameters =</span> <span class="kw">list</span>(<span class="dt">substrate =</span> <span class="st">"substrate"</span>, <span class="dt">product =</span> <span class="st">"product"</span>)
)
<span class="co">#&gt; [1] "FunctionDB.Functions[manual MM]"</span>
<span class="kw"><a href="../reference/newReaction.html">newReaction</a></span>(
  <span class="st">"a = b"</span>,
  <span class="dt">fun =</span> <span class="st">"manual MM"</span>,
  <span class="dt">mapping =</span> <span class="kw">list</span>(
    <span class="dt">substrate =</span> <span class="st">"a"</span>,
    <span class="dt">product =</span> <span class="st">"b"</span>,
    <span class="dt">Vf =</span> <span class="fl">0.1</span>,
    <span class="dt">Kms =</span> <span class="fl">0.1</span>,
    <span class="dt">Vr =</span> <span class="fl">0.1</span>,
    <span class="dt">Kmp =</span> <span class="fl">0.1</span>
  )
)
<span class="co">#&gt; [1] "(a = b)"</span>

timecourse &lt;-<span class="st"> </span><span class="kw"><a href="../reference/runTimeCourse.html">runTC</a></span>(<span class="dv">1000</span>)

<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/autoplot">autoplot</a></span>(timecourse)</code></pre></div>
<p><img src="model_building_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw"><a href="../reference/unloadModel.html">unloadModel</a></span>()</code></pre></div>
</div>
<div id="quantities-as-proxy-for-time-course-output" class="section level1">
<h1 class="hasAnchor">
<a href="#quantities-as-proxy-for-time-course-output" class="anchor"></a>Quantities as Proxy for Time Course Output</h1>
<p>The <code>runTC</code> function only returns actual defined entities of the model. Auxiliarry information like reaction rates can be missing and and need to be added via global quantity assignment.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/newModel.html">newModel</a></span>()
<span class="co">#&gt; # A copasi model reference:</span>
<span class="co">#&gt; Model name: "New Model"</span>
<span class="co">#&gt; Number of compartments: 0</span>
<span class="co">#&gt; Number of species: 0</span>
<span class="co">#&gt; Number of reactions: 0</span>

subs_quant &lt;-<span class="st"> </span><span class="kw"><a href="../reference/newGlobalQuantity.html">newGlobalQuantity</a></span>(<span class="st">"substrate concentration"</span>, <span class="dt">initial_value =</span> <span class="dv">10</span>)
subs_value &lt;-<span class="st"> </span><span class="kw"><a href="../reference/entity_finders.html">quantity</a></span>(subs_quant, <span class="dt">reference =</span> <span class="st">"Value"</span>)

<span class="kw"><a href="../reference/newSpecies.html">newSpecies</a></span>(<span class="st">"a"</span>, <span class="dt">type =</span> <span class="st">"assignment"</span>, <span class="dt">expression =</span> subs_value)
<span class="co">#&gt; Warning: No compartment exists. Created default compartment.</span>
<span class="co">#&gt; [1] "a{compartment}"</span>
<span class="kw"><a href="../reference/newReaction.html">newReaction</a></span>(<span class="st">"a = b"</span>, <span class="dt">fun =</span> <span class="st">"Reversible Michaelis-Menten"</span>)
<span class="co">#&gt; [1] "(a = b)"</span>

<span class="kw"><a href="../reference/runTimeCourse.html">runTC</a></span>(<span class="dv">1000</span>)<span class="op">$</span>result
<span class="co">#&gt; # A tibble: 101 x 3</span>
<span class="co">#&gt;     Time     b     a</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1   0    1.00  10.0</span>
<span class="co">#&gt;  2  10.0  1.75  10.0</span>
<span class="co">#&gt;  3  20.0  2.40  10.0</span>
<span class="co">#&gt;  4  30.0  2.97  10.0</span>
<span class="co">#&gt;  5  40.0  3.48  10.0</span>
<span class="co">#&gt;  6  50.0  3.94  10.0</span>
<span class="co">#&gt;  7  60.0  4.35  10.0</span>
<span class="co">#&gt;  8  70.0  4.72  10.0</span>
<span class="co">#&gt;  9  80.0  5.06  10.0</span>
<span class="co">#&gt; 10  90.0  5.37  10.0</span>
<span class="co">#&gt; # ... with 91 more rows</span>

<span class="kw"><a href="../reference/newGlobalQuantity.html">newGlobalQuantity</a></span>(
  <span class="st">"reaction rate"</span>,
  <span class="dt">type =</span> <span class="st">"assignment"</span>,
  <span class="dt">expression =</span> <span class="kw"><a href="../reference/entity_finders.html">reaction</a></span>(<span class="st">"a = b"</span>, <span class="dt">reference =</span> <span class="st">"Flux"</span>)
)
<span class="co">#&gt; [1] "Values[reaction rate]"</span>

<span class="kw"><a href="../reference/runTimeCourse.html">runTC</a></span>(<span class="dv">1000</span>)<span class="op">$</span>result
<span class="co">#&gt; # A tibble: 101 x 4</span>
<span class="co">#&gt;     Time     b     a `Values[reaction rate]`</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;                   &lt;dbl&gt;</span>
<span class="co">#&gt;  1   0    1.00  10.0                  0.0811</span>
<span class="co">#&gt;  2  10.0  1.75  10.0                  0.0696</span>
<span class="co">#&gt;  3  20.0  2.40  10.0                  0.0608</span>
<span class="co">#&gt;  4  30.0  2.97  10.0                  0.0538</span>
<span class="co">#&gt;  5  40.0  3.48  10.0                  0.0480</span>
<span class="co">#&gt;  6  50.0  3.94  10.0                  0.0432</span>
<span class="co">#&gt;  7  60.0  4.35  10.0                  0.0391</span>
<span class="co">#&gt;  8  70.0  4.72  10.0                  0.0356</span>
<span class="co">#&gt;  9  80.0  5.06  10.0                  0.0326</span>
<span class="co">#&gt; 10  90.0  5.37  10.0                  0.0299</span>
<span class="co">#&gt; # ... with 91 more rows</span>

<span class="kw"><a href="../reference/unloadModel.html">unloadModel</a></span>()</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#initial-setup">Initial Setup</a></li>
      <li><a href="#quick-model-building">Quick Model Building</a></li>
      <li><a href="#more-detail">More Detail</a></li>
      <li><a href="#defining-reaction-kinetics-manually">Defining Reaction Kinetics Manually</a></li>
      <li><a href="#quantities-as-proxy-for-time-course-output">Quantities as Proxy for Time Course Output</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jonas Förster, Jürgen Pahle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
